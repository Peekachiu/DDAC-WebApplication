name: Build and Run

on:
  push:
    branches: [ "main" ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run Docker Compose
        # THIS IS THE MAGIC PART
        # We map the GitHub Secrets (Left) to the Environment Variables (Right)
        env:
          SECRET_KEY: ${{ secrets.SECRET_KEY }}           # Your backend key
          PUBLISHABLE_KEY: ${{ secrets.PUBLISHABLE_KEY }} # Your frontend key
        run: |
          # Docker Compose will automatically read the 'env' variables above
          docker-compose up -d --build